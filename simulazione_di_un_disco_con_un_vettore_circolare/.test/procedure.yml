rules:
  - id: errore-while-signal-and-wait
    languages:
      - c
    severity: ERROR
    message: "È un monitor signal and wait, non è necessario il ciclo while."
    patterns:
      - pattern: |
          enter_monitor(...);
          ...
          while($COND){
            ...
            wait_condition(...); 
            ...
          }
          ...
          leave_monitor(...);
  - id: errore-incremento-testa-mancante
    languages:
      - c
    severity: ERROR
    message: "Manca l'incremento della testa nella condizione del costrutto IF della funzione InserisciRichiesta()."
    patterns:
      - pattern: |
          void InserisciRichiesta(...){
            enter_monitor(...);
            ...
            if($CONDITION){
              ...
              wait_condition(...);
            }
            ...
            signal_condition(...);
            ...
            leave_monitor(...);
          }
      - metavariable-pattern:
          metavariable: $CONDITION
          patterns:
            - pattern-not: "(($S->$TESTA + 1) % $DIMENSIONE_CODA) == $S->$CODA"